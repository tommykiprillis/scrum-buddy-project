<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
	<title>Scrum Buddy</title>
	<style>

		.Front-End-badge {
			background-color:#70d6ff;
			color: white;
		}

		.Back-End-badge {
			background-color:#ff70a6;
			color: white;
		}

		.API-badge {
			background-color:#ff9770;
			color: white;
		}

		.Databases-badge {
			background-color:#ffd670;
			color: white;
		}

		.Testing-badge {
			background-color:#7bf1a8;
			color: white;
		}

		.UIUX-badge {
			background-color:#7161ef;
			color: white;
		}
	</style>
</head>

<body>
  <!-- header of the scrum board-->
  <div class="mt-5 px-5">
    <h1 class="mb-4">Sprint Board</h1>

    <div class="btn-group">
      <button type="button" class="btn bg-body-secondary dropdown-toggle " data-bs-toggle="dropdown" aria-expanded="false">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-columns-gap" viewBox="0 0 16 16">
          <path d="M6 1v3H1V1zM1 0a1 1 0 0 0-1 1v3a1 1 0 0 0 1 1h5a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1zm14 12v3h-5v-3zm-5-1a1 1 0 0 0-1 1v3a1 1 0 0 0 1 1h5a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1zM6 8v7H1V8zM1 7a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h5a1 1 0 0 0 1-1V8a1 1 0 0 0-1-1zm14-6v7h-5V1zm-5-1a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h5a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"/>
        </svg>
        View
      </button>
      <ul class="dropdown-menu">
        <li><button class="dropdown-item" type="button">Card View</button></li>
        <li><button class="dropdown-item" type="button">List View</button></li>
      </ul>      
    </div>

    <div class="btn-group">
      <button type="button" class="btn bg-body-secondary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-funnel" viewBox="0 0 16 16">
          <path d="M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.342.474l-3 1A.5.5 0 0 1 6 14.5V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5zm1 .5v1.308l4.372 4.858A.5.5 0 0 1 7 8.5v5.306l2-.666V8.5a.5.5 0 0 1 .128-.334L13.5 3.308V2z"/>
        </svg>
        Sort By
      </button>
      <ul class="dropdown-menu dropdown-menu-end">
        <li><button class="dropdown-item" type="button">Priority</button></li>
        <li><button class="dropdown-item" type="button">Name</button></li>
        <li><button class="dropdown-item" type="button">Tag</button></li>
        <li><button class="dropdown-item" type="button">Name</button></li>
      </ul>    
    </div>

  </div>

  <!-- Card View Start-->
  <div class="d-flex justify-content-start gap-4 p-5 align-items-start" >
    
    <!-- To Do Column-->
    <div class="card d-flex align-items-center flex-column bg-body-secondary gap-3 py-3 border border-0 px-3">
      <!-- Title of Column-->
      <div class="d-flex gap-2 justify-content-start" style="width:20rem">
        <h4 class="text-start">To Do</h4>
        <h4 class="text-body-secondary"><%= tasks.length %></h4>
      </div>
      
      <% tasks.forEach(task => { %>
        <!-- Task Entry-->
        <div class="card border border-0 shadow-sm" style = "width:20rem;">
          <div class="card-body">
            <div class="d-flex justify-content-end align-items-center gap-3 mb-2">
              <% if (task.priority !== null) { %>
                <span class="badge text-bg-dark rounded-pill p-2 me-auto"><%=task.priority%></span>
              <% } %>
              <% if (task.story_points !== null) { %>
                <div class="text-body-secondary"><%=task.story_points%>pts</div>
              <% } %>
              <button class="btn bg-body-secondary rounded-circle p-1 lh-1 d-flex align-items-center justify-content-center" type="button" data-bs-toggle="modal" data-bs-target="#detailed<%= task.id %>" aria-expanded="false">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-three-dots" viewBox="0 0 16 16">
                  <path d="M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3"/>
                </svg>
              </button>         
            </div>
            <h5 class="card-title"><%= task.title %></h5>
            <% if (task.assignee !== null) { %>
              <h6 class="card-subtitle mb-2 text-body-secondary"><%=task.assignee%></h6>
            <% } %>
            <div class="d-flex gap-2 justify-content-start w-100 align-items-center">
              <% if (task.tag !== null) { %>
                <span class="badge <%=task.tag%>-badge py-1 d-flex align-items-center"><%=task.tag%></span>
              <% } %>
              <div class="btn-group dropend ms-auto">
                <button class="btn bg-body-secondary rounded-circle p-1 lh-1 d-flex align-items-center justify-content-center" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left-right" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M1 11.5a.5.5 0 0 0 .5.5h11.793l-3.147 3.146a.5.5 0 0 0 .708.708l4-4a.5.5 0 0 0 0-.708l-4-4a.5.5 0 0 0-.708.708L13.293 11H1.5a.5.5 0 0 0-.5.5m14-7a.5.5 0 0 1-.5.5H2.707l3.147 3.146a.5.5 0 1 1-.708.708l-4-4a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 4H14.5a.5.5 0 0 1 .5.5"/>
                  </svg>
                </button>
                <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <li><h6 class="dropdown-header">Move to</h6></li>
                  <li><button class="dropdown-item" type="button">To Do</button></li>
                  <li><button class="dropdown-item" type="button">In Progress</button></li>
                  <li><button class="dropdown-item" type="button">Done</button></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      <% }) %>
      

      <!-- Add Task Form-->
      <div class="collapse" id="createTask" style = "width:20rem;">
        <div class="card border border-0 shadow-sm">
          <div class="card-body">
              <h5 class="card-title">Add Task</h5>

              <form action="/add" method="POST">
                <input type="text" class="form-control" name="taskName" autocomplete="off">
              </form>

          </div>
        </div>
      </div>

      <!-- Add Task Button-->
      <div class="d-flex justify-content-center" style = "width:20rem;">
        <button class="btn btn-dark rounded-circle p-1 lh-1" type="button" data-bs-toggle="collapse" data-bs-target="#createTask" aria-expanded="false" aria-controls="createTask">
          <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2"/>
            </svg>
        </button>
      </div>
    </div>
    <!-- To Do Column End-->

    <!-- In Progress Column-->
    <div class="card d-flex align-items-center flex-column bg-body-secondary gap-3 py-3 border border-0 px-3">
      <!-- Title of Column-->
      <div class="d-flex gap-2 justify-content-start" style="width:20rem">
        <h4 class="text-start">In Progress</h4>
        <h4 class="text-body-secondary"><%= tasks.length %></h4>
      </div>
    </div>

    <!-- Done Column-->
    <div class="card d-flex align-items-center flex-column bg-body-secondary gap-3 py-3 border border-0 px-3">
      <!-- Title of Column-->
      <div class="d-flex gap-2 justify-content-start" style="width:20rem">
        <h4 class="text-start">Done</h4>
        <h4 class="text-body-secondary"><%= tasks.length %></h4>
      </div>
    </div>
  </div>
  <!-- Card View End-->

  <% tasks.forEach(task => { %>
    <!-- Edit/View More for each task (for both list and card views)-->
    <div class="modal fade" id="detailed<%= task.id %>" tabindex="-1">
      <div class="modal-dialog" style="max-width: 50rem;">
        <div class="modal-content">
          <div class="modal-body">
            <form action="/edit" method="POST">
              <!--Stores the id of the task as a hidden value-->
              <input type="hidden" name="id" value="<%=task.id%>">

              <!--Task Name at top (prefill + save)-->
              <label for="titleInput<%= task.id %>" class="form-label">Task Name</label>
              <input class="form-control form-control" id="titleInput<%= task.id %>" type="text" value="<%=task.title%>" name="taskName" autocomplete="off">
              
              <!--Delete Task Option (own form)-->

              <!--Assignee (prefill + save)-->
              <label for="assigneeInput<%= task.id %>" class="form-label mt-3">Assignee</label>
              <input class="form-control form-control" id="assigneeInput<%= task.id %>" type="text"
              <% if (task.assignee !== null) { %>
                value="<%=task.assignee%>"
              <% } %>
              name="taskAssignee" autocomplete="off">
              
              
              <div class="row mt-3">
                <div class="col">
                  <!--Tags (dropdown prefill + save, for now only 1 tag at a time)-->
                  <label for="tag<%= task.id %>" class="form-label">Tag</label>
                  <select class="form-control form-control-sm" id="tag<%= task.id %>" name="taskTag">
                    <% if (task.tag !== null) { %>
                      <option value="<%=task.tag%>" selected><%=task.tag%></option>
                    <% } else {%>
                      <option value="" selected>None</option>
                    <% } %>
                    <option value="Back-End">Back-End</option>
                    <option value="Front-End">Front-End</option>
                    <option value="API">API</option>
                    <option value="Databases">Databases</option>
                    <option value="Testing">Testing</option>
                    <option value="UIUX">UIUX</option>
                  </select>

                </div>

                <div class="col">
                  <!--Priority (dropdown prefill + save)-->
                  <label for="priority<%= task.id %>" class="form-label">Priority</label>
                  <select class="form-control form-control-sm" id="priority<%= task.id %>" name="taskPriority">
                    <% if (task.priority !== null) { %>
                      <option value="<%=task.priority%>" selected><%=task.priority%></option>
                      <% } else {%>
                        <option value="" selected>None</option>
                      <% } %>
                    <option value="Urgent">Urgent</option>
                    <option value="Low">Low</option>
                    <option value="Medium">Medium</option>
                    <option value="Important">Important</option>
                  </select>

                </div>

                <div class="col">
                  <!--Story Points (prefill + save)-->
                  <label for="storyInput<%= task.id %>" class="form-label">Story Points</label>
                  <input class="form-control form-control-sm" id="storyInput<%= task.id %>" type="text"
                  <% if (task.story_points !== null) { %>
                    value="<%=task.story_points%>"
                  <% } %>
                  name="taskStoryPoint" autocomplete="off">
                </div>
              </div>

              
              <!--Description (prefill + save)-->
              <label for="descriptionInput<%= task.id %>" class="form-label mt-3">Description</label>
              <textarea class="form-control" id="descriptionInput<%= task.id %>" rows="3" name="taskDescription" autocomplete="off"><% if (task.description !== null) { %><%=task.description%><% } %></textarea>

              <!--Saving Changes-->
              <button type="submit" class="btn bg-body-secondary mt-3">Save Changes</button>
            </form>
            <form action="/delete" method="POST">
                <!--Delete Task-->
                <input type="hidden" name="id" value="<%=task.id%>">
                <button type="submit" class="btn btn-outline-danger mt-3">Delete Task</button>
            </form>
          </div>
        </div>
      </div>
    </div>
  <% }) %>
  
  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>

</html>